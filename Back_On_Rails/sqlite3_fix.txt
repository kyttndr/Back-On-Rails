Install DevKit

Get autoconf version of sqlite3 sources from https://www.sqlite.org/download.html

Start msys shell of DevKit (I have gcc from strawberry perl on PATH, this way I'm sure correct compiler is used)

In unpacked location for your sqlite3 configure static version only to avoid keeping DLL on PATH ./configure --disable-shared

Build and install it make install DESTDIR=/c/dev/ruby/tmp

Remove all existing sqlite3 gems gem uninstall sqlite3 --all

Build and install this gem gem install sqlite3 --platform=ruby -- --with-sqlite3-include=/c/dev/ruby/tmp/usr/local/include --with-sqlite3-lib=/c/dev/ruby/tmp/usr/local/lib

Actual command progression:
gem uninstall sqlite3 --all
gem install sqlite3 --platform=ruby -- --with-sqlite3-include=C:\sqlite --with-sqlite3-lib=C:\sqlite\.libs