I"þ(function() {
  $(window).load(function() {
    return window.initMap();
  });

  $(document).on('turbolinks:load', function() {
    return window.initMap();
  });

  jQuery(function() {
    return window.initMap = function() {
      var geocoder, i, map, marker;
      if (window.location.href.split('/').pop() === 'places') {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {
            lat: 43.66090860000001,
            lng: -79.39595179999999
          },
          zoom: 13
        });
        i = 0;
        while (i < gon.places.length) {
          marker = new google.maps.Marker({
            position: {
              lat: gon.places[i].latitude,
              lng: gon.places[i].longitude
            },
            title: gon.places[i].address,
            map: map,
            animation: google.maps.Animation.DROP,
            url: '/places/' + gon.places[i].id
          });
          marker.addListener('click', function() {
            window.location.href = this.url;
          });
          i++;
        }
      } else if (window.location.href.split('/').pop() === 'new') {
        map = new google.maps.Map(document.getElementById('form_map'), {
          center: {
            lat: 43.66090860000001,
            lng: -79.39595179999999
          },
          zoom: 13
        });
        geocoder = new google.maps.Geocoder;
        google.maps.event.addListener(map, 'click', function(event) {
          geocoder.geocode({
            'latLng': event.latLng
          }, function(results, status) {
            if (status === google.maps.GeocoderStatus.OK) {
              if (results[0]) {
                $('#place_address').val(results[0].formatted_address);
              }
            }
          });
        });
      } else {
        map = new google.maps.Map(document.getElementById('show_map'), {
          center: {
            lat: gon.place.latitude,
            lng: gon.place.longitude
          },
          zoom: 13
        });
      }
    };
  });

}).call(this);
:ET